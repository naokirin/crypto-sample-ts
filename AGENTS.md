# AGENTS.md

このドキュメントは、TypeScriptで暗号技術のサンプルコードを作成する際のガイドラインです。

## プロジェクトの目的

このプロジェクトは、各種暗号技術の実装例をTypeScriptで提供することを目的としています。学習や理解を深めるための実用的なサンプルコードを提供します。

## コーディングスタイル

- **言語**: TypeScript
- **パッケージマネージャー**: npm
- **リンター・フォーマッター**: biome
- **コードスタイル**: 明確で読みやすいコードを心がける
- **コメント**: 複雑な処理や暗号学的な概念には適切な説明を追加

## ファイル構造

```
crypto-sample-ts/
├── src/
│   ├── symmetric/          # 対称鍵暗号
│   ├── asymmetric/         # 非対称鍵暗号
│   ├── hash/               # ハッシュ関数
│   ├── digital-signature/  # デジタル署名
│   ├── key-exchange/       # 鍵交換
│   ├── post-quantum/       # 耐量子暗号
│   ├── searchable/         # 検索可能暗号
│   ├── utils/              # ユーティリティ関数
│   └── web/                # Webページ用のTypeScriptコード
├── tests/                  # テストファイル
├── docs/                   # ドキュメント
├── dist-web/               # Webページのビルド出力
├── index.html              # WebページのメインHTMLファイル
├── vite.config.ts          # Viteの設定ファイル
├── package.json            # プロジェクトの依存関係とスクリプト
├── tsconfig.json           # TypeScriptの設定
├── biome.json              # リンター・フォーマッターの設定
└── .gitignore              # Gitの除外設定
```

## サンプルコード作成の方針

### 1. 各暗号技術のサンプルには以下を含める

- **基本的な使用例**: 最もシンプルな使用パターン
- **エラーハンドリング**: 適切なエラー処理の例
- **型安全性**: TypeScriptの型を活用した安全な実装
- **コメント**: 暗号学的な概念や処理の説明

### 2. 実装の原則

- **セキュリティ**: 実装例であっても、セキュリティのベストプラクティスに従う
- **明確性**: コードは教育的な目的も兼ねているため、理解しやすさを重視
- **実用性**: 実際の使用場面を想定した実装例を提供

### 3. ドキュメント

- 各サンプルコードには、その暗号技術の基本的な説明を含める
- 数学的な定義を使用する場合は、事前に説明を追加する
- ストーリーとして理解しやすい流れで記述する
- 例えや前置きを多用せず、簡潔に記述する

## 対応予定の暗号技術

### 対称鍵暗号
- AES (Advanced Encryption Standard)
- ChaCha20
- Poly1305 (認証付き暗号)
- その他

### 非対称鍵暗号
- RSA
- ECC (Elliptic Curve Cryptography)
- IDベース暗号 (Identity-Based Encryption)
- 属性ベース暗号 (Attribute-Based Encryption)
- その他

### ハッシュ関数
- SHA-256, SHA-512
- SHA-3
- BLAKE2
- SipHash
- その他

### デジタル署名
- RSA署名
- ECDSA
- EdDSA
- 匿名署名 (Anonymous Signature)
- その他

### 鍵交換
- Diffie-Hellman
- ECDH
- その他

### 検索可能暗号
- 検索可能暗号 (Searchable Encryption)

### 耐量子暗号 (Post-Quantum Cryptography)
NIST標準選定された耐量子暗号:
- **鍵交換**
  - CRYSTALS-Kyber
- **デジタル署名**
  - CRYSTALS-Dilithium
  - FALCON
  - SPHINCS+

## Webデモ

各暗号技術の動作を視覚的に確認できるWebページを提供しています。

### 技術スタック

- **ビルドツール**: Vite
- **フロントエンドフレームワーク**: Alpine.js
- **スタイリング**: インラインCSS（シンプルな実装）

### 機能

Webページでは以下の機能を提供します：

1. **暗号技術の選択**: ドロップダウンから暗号技術を選択
2. **鍵生成**: 各暗号技術の鍵生成プロセスを可視化
3. **暗号化/復号化**: 暗号化と復号化の各ステップを段階的に表示
4. **詳細情報の表示**: 各ステップの内部処理を詳細に表示
   - データ変換の段階表示（文字列 → バイト配列 → 暗号文）
   - バイトレベルの詳細表示（16進数、10進数、2進数、ASCII）
   - 処理フローの説明
5. **MAC計算/検証**: Poly1305のMAC計算と検証機能

### 開発コマンド

```bash
# 開発サーバーの起動
npm run web:dev

# ビルド
npm run web:build

# ビルド結果のプレビュー
npm run web:preview
```

### 実装の特徴

- **デフォルトで詳細表示**: 各ステップの詳細情報がデフォルトで表示される
- **段階的な可視化**: データの変換過程を段階的に表示
- **バイトレベルの詳細**: 各バイトの詳細情報を表形式で表示
- **処理フローの説明**: 各ステップで何が起こっているかを説明

## テスト

- 各サンプルコードには、基本的な動作確認のためのテストを含める
- **テストフレームワーク**: Vitest

## コミットメッセージのフォーマット

コミットメッセージは以下のいずれかの形式をPrefixとして使用してください:

- `feat`: 新機能の追加
- `fix`: バグ修正
- `docs`: ドキュメントのみの変更
- `style`: コードの意味に影響しない変更（空白、フォーマット、セミコロンの追加など）
- `refactor`: バグ修正でも新機能追加でもないコード変更
- `perf`: パフォーマンス改善のためのコード変更
- `test`: 不足しているテストの追加や既存のテストの修正
- `chore`: ビルドプロセスや補助ツール、ライブラリの変更（ドキュメント生成など）

## 注意事項

- 実装例は教育目的であり、本番環境で使用する場合は十分な検証が必要
- セキュリティクリティカルな実装では、専門家のレビューを推奨
- 暗号学的に安全な乱数生成器を使用する
- 鍵管理のベストプラクティスに従う

## 作業フロー

1. 新しい暗号技術のサンプルを追加する際は、適切なディレクトリに配置
2. サンプルコードとテストを作成
3. 必要に応じてドキュメントを更新
4. コードレビューとテストを実施
5. **コミット前に必ずリンター・フォーマッター（biome）を実行し、エラーがないことを確認する**

