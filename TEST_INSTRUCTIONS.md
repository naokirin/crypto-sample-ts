# IBE実装のテスト手順

## ブラウザでの動作確認

### 1. 開発サーバーの起動

```bash
npm run web:dev
```

開発サーバーが起動したら、ブラウザで以下のURLにアクセスしてください：

- **完全なテストページ**: http://localhost:3000/test-ibe-full.html
- **基本的なテストページ**: http://localhost:3000/test-ibe.html

### 2. テストの実行

テストページで以下のボタンをクリックしてテストを実行してください：

1. **すべてのテストを実行** - すべての機能を順番にテスト
2. **Setup テスト** - マスター鍵ペアの生成をテスト
3. **Extract テスト** - アイデンティティから秘密鍵を抽出する機能をテスト
4. **Encrypt/Decrypt テスト** - 暗号化と復号化の機能をテスト

### 3. 期待される結果

#### Setup テスト
- ✅ マスター鍵ペアが正常に生成される
- ✅ マスター鍵と公開パラメータのサイズが正しい

#### Extract テスト
- ✅ アイデンティティから秘密鍵が正常に抽出される
- ✅ 秘密鍵のサイズが正しい

#### Encrypt/Decrypt テスト
- ✅ メッセージが正常に暗号化される
- ✅ 暗号文が正常に復号化される
- ✅ 復号化されたメッセージが元のメッセージと一致する

## 実装された機能

### ✅ Setup（マスター鍵ペアの生成）
- ランダムなマスター秘密鍵を生成
- 公開パラメータP_pub = sPを計算
- マスター鍵と公開パラメータを返す

### ✅ Extract（アイデンティティから秘密鍵を抽出）
- SHA-256でアイデンティティをハッシュ化
- 秘密鍵d_ID = sH(ID)を計算
- 秘密鍵を返す

### ✅ Encrypt（メッセージの暗号化）
- ランダムなrを選択
- U = rPを計算
- V = M ⊕ H(e(P_pub, H(ID))^r)を計算
- 暗号文C = (U, V)を返す

### ✅ Decrypt（暗号文の復号化）
- 暗号文C = (U, V)を解析
- e(d_ID, U)を計算
- M = V ⊕ H(e(d_ID, U))を計算
- メッセージMを返す

## 注意事項

1. **初回実行時**: WebAssemblyモジュールのロードに数秒かかる場合があります
2. **パフォーマンス**: ペアリング演算は計算コストが高いため、処理に時間がかかる場合があります
3. **ブラウザのコンソール**: エラーが発生した場合は、ブラウザの開発者ツールのコンソールを確認してください

## トラブルシューティング

### WebAssemblyモジュールのロードに失敗する場合

1. 開発サーバーが正しく起動しているか確認
2. ブラウザのコンソールでエラーメッセージを確認
3. `wasm-src/ibe-wasm/pkg/`ディレクトリにWasmファイルが存在するか確認

### テストが失敗する場合

1. ブラウザのコンソールでエラーメッセージを確認
2. ネットワークタブでWasmファイルのロードを確認
3. ブラウザのキャッシュをクリアして再試行

